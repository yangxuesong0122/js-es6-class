<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div>
      <ul>
        <li>苹果</li>
        <li>樱桃</li>
        <li>水蜜桃</li>
        <li>榴莲</li>
      </ul>
    </div>
    <script>
      // 立即执行函数中的函数与立即执行函数中的函数可以构成一个闭包。正是由于立即执行函数的这个闭包特性，可以解决点击事件和定时器中的索引值问题。
      // 面试问题：如何通过闭包实现点击li打印对应的索引号
      // 实现原理：立即执行函数+点击事件（点击事件中想要获取的变量可以通过立即执行函数来获取）
      
      // 闭包应用1：点击li标签后输出对应的索引号
      // 方法一：动态添加属性的方式
      let lis = document.querySelectorAll("li")
      // for (var i = 0; i < lis.length; i++) {
      //   lis[i].index = i
      //   lis[i].onclick = function () {
      //     // console.log(i) // 输出的是 4
      //     console.log(this.index)
      //   }
      // }
      // 方法二：闭包
      for (var i = 0; i < lis.length; i++) {
        // 利用for循环创建4个立即执行函数
        // 立即执行函数也称为小闭包，因为立即执行函数里面的任何一个函数都可以使用它的 i 这个变量
        (function (i) {
          lis[i].onclick = function () {
            console.log(i)
          }
        })(i)
      }
    </script>
  </body>
</html>
